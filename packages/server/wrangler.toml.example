name = "ota-update-server"
main = "src/index.ts"
compatibility_date = "2024-01-01"

# D1 Database for metadata
# Create with: wrangler d1 create ota-update-db
[[d1_databases]]
binding = "DB"
database_name = "ota-update-db"
database_id = "YOUR_D1_DATABASE_ID"

# KV Namespace for caching
# Create with: wrangler kv:namespace create CACHE
[[kv_namespaces]]
binding = "CACHE"
id = "YOUR_KV_NAMESPACE_ID"

# R2 Bucket for bundle storage
# Create with: wrangler r2 bucket create ota-update-bundles
[[r2_buckets]]
binding = "BUNDLES"
bucket_name = "ota-update-bundles"

# Environment variables
[vars]
ENVIRONMENT = "development"

# Production environment
[env.production]
vars = { ENVIRONMENT = "production" }

# Rate limiting (optional, requires paid plan)
# [[unsafe.bindings]]
# name = "RATE_LIMITER"
# type = "ratelimit"
# namespace_id = "1001"
# simple = { limit = 100, period = 60 }
